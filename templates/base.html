<!doctype html>
<html lang="{{ current_lang }}" dir="{{ text_dir(current_lang) }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Tighri{% endblock %}</title>
  <link rel="icon" href="{{ url_for('favicon') }}">
  <style>
    :root{--primary:#8B5CF6;--ink:#2d1a47}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial}
    .topbar{display:flex;align-items:center;gap:1rem;justify-content:space-between;padding:.85rem 1rem;background:#fff;border-bottom:1px solid #eee;position:sticky;top:0;z-index:50}
    .brand{font-weight:800;color:var(--ink);text-decoration:none}
    .nav{list-style:none;margin:0;padding:0;display:flex;gap:1rem;flex-wrap:wrap}
    .nav a{color:#444;text-decoration:none}
    .nav a:hover{color:var(--primary)}
    .actions{display:flex;align-items:center;gap:.75rem}
    .lang{position:relative}
    .lang-btn{border:1px solid #e5e7eb;background:#fff;border-radius:999px;padding:.35rem .7rem;cursor:pointer}
    .lang-menu{position:absolute;inset:auto 0 0 auto;transform:translateY(110%);background:#fff;border:1px solid #eee;border-radius:.5rem;box-shadow:0 8px 24px rgba(0,0,0,.08);display:none;min-width:140px}
    .lang-menu a{display:block;padding:.55rem .75rem;text-decoration:none;color:#333}
    .lang-menu a:hover{background:#f7f7fb}
    .lang.open .lang-menu{display:block}
  </style>
  {% block extra_css %}{% endblock %}
</head>
<body>
  <nav class="topbar" aria-label="Main">
    <a class="brand" href="{{ url_for('index') }}">brand<span style="color:#8B5CF6">❤</span></a>

    <ul class="nav">
      <li><a href="{{ url_for('index') }}">{{ t('nav.home') }}</a></li>
      <li><a href="{{ url_for('professionals') }}">{{ t('nav.professionals') }}</a></li>
      <li><a href="{{ url_for('anthecc') }}">{{ t('nav.anthecc') }}</a></li>
      <li><a href="{{ url_for('about') }}">{{ t('nav.about') }}</a></li>
      <li><a href="{{ url_for('contact') }}">{{ t('nav.contact') }}</a></li>
    </ul>

    <div class="actions">
      <div class="lang" id="langBox">
        <button class="lang-btn" type="button" aria-haspopup="menu" aria-expanded="false">
          {{ current_lang_label }}
        </button>
        <div class="lang-menu" role="menu" aria-label="Language">
          <a role="menuitem" href="{{ url_for('set_language_path', code='fr') }}">Français</a>
          <a role="menuitem" href="{{ url_for('set_language_path', code='en') }}">English</a>
          <a role="menuitem" href="{{ url_for('set_language_path', code='ar') }}">العربية</a>
        </div>
      </div>

      {% if current_user.is_authenticated %}
        <a href="{{ url_for('professional_dashboard') }}">dashboard</a>
        <a href="{{ url_for('logout') }}">{{ t('auth.logout') }}</a>
      {% else %}
        <a href="{{ url_for('login') }}">{{ t('auth.login') }}</a>
      {% endif %}
    </div>
  </nav>

  {% block content %}{% endblock %}

  {% block extra_js %}{% endblock %}
  <script>
    (function(){
      const box=document.getElementById('langBox');
      if(!box) return;
      const btn=box.querySelector('.lang-btn');
      btn.addEventListener('click',()=>{ box.classList.toggle('open'); btn.setAttribute('aria-expanded',box.classList.contains('open'));});
      document.addEventListener('click',(e)=>{ if(!box.contains(e.target)) { box.classList.remove('open'); btn.setAttribute('aria-expanded','false'); }});
    })();
  </script>
</body>
</html>
