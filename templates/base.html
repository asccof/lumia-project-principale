<!DOCTYPE html>
<html lang="{{ current_lang }}" dir="{{ dir_value|default('ltr') }}">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>{% block title %}Tighri{% endblock %}</title>

  {# CSS global éventuel de ton projet #}
  {# <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}"> #}

  {% block extra_css %}{% endblock %}
  <style>
    /* Mini styles NE CHANGENT PAS la police : uniquement mise en page nav + flash */
    .site-nav{display:flex;align-items:center;justify-content:space-between;gap:1rem;padding:.75rem 1rem;border-bottom:1px solid #eee;background:#fff}
    .nav-left,.nav-right{display:flex;align-items:center;gap:.75rem;flex-wrap:wrap}
    .brand{font-weight:700;text-decoration:none;color:inherit}
    .nav-link{color:inherit;text-decoration:none;padding:.35rem .6rem;border-radius:.4rem}
    .nav-link:hover{background:#f4f4f8}
    .lang-switch{display:flex;align-items:center;gap:.25rem}
    .lang-switch a{padding:.25rem .5rem;border-radius:.4rem;text-decoration:none}
    .lang-switch .is-active{background:#efeff6;font-weight:700}
    .flash{margin:0 auto;max-width:1100px;padding:.75rem 1rem;border-radius:.5rem}
    .flash.info{background:#eef6ff}
    .flash.success{background:#ebf7ee}
    .flash.warning{background:#fff9e6}
    .flash.danger{background:#ffecec}
    main{min-height:60vh}
    footer{border-top:1px solid #eee;padding:1.25rem 1rem;margin-top:2rem;color:#555}
  </style>
</head>
<body>

  <header class="site-nav">
    <div class="nav-left">
      <a class="brand" href="{{ url_for('index') }}">Tighri</a>
      <a class="nav-link" href="{{ url_for('professionals') }}">{{ t('nav.professionals','Professionnels') }}</a>
      <a class="nav-link" href="{{ url_for('anthecc') }}">{{ t('nav.anthecc','ANTHECC') }}</a>
      <a class="nav-link" href="{{ url_for('about') }}">{{ t('nav.about','À propos') }}</a>
      <a class="nav-link" href="{{ url_for('contact') }}">{{ t('nav.contact','Contact') }}</a>
    </div>

    <div class="nav-right">
      {% if current_user.is_authenticated %}
        {% if current_user.user_type == 'professional' %}
          <a class="nav-link" href="{{ url_for('professional_dashboard') }}">Mon espace</a>
        {% else %}
          <a class="nav-link" href="{{ url_for('my_appointments') }}">Mes rendez-vous</a>
        {% endif %}
        <a class="nav-link" href="{{ url_for('logout') }}">{{ t('auth.logout','Déconnexion') }}</a>
      {% else %}
        <a class="nav-link" href="{{ url_for('login') }}">{{ t('auth.login','Connexion') }}</a>
        <a class="nav-link" href="{{ url_for('register') }}">{{ t('auth.register','Inscription') }}</a>
      {% endif %}

      <nav class="lang-switch" aria-label="Langue">
        {# aucune police ajoutée ; simple switch. Le courant est en surbrillance #}
        <a href="{{ url_for('set_language_path', code='fr') }}"
           class="{{ 'is-active' if current_lang=='fr' else '' }}">FR</a>
        <a href="{{ url_for('set_language_path', code='en') }}"
           class="{{ 'is-active' if current_lang=='en' else '' }}">EN</a>
        <a href="{{ url_for('set_language_path', code='ar') }}"
           class="{{ 'is-active' if current_lang=='ar' else '' }}">AR</a>
      </nav>
    </div>
  </header>

  {# messages flash #}
  <section style="padding:0 1rem;margin-top:.75rem">
    {% with msgs = get_flashed_messages(with_categories=true) %}
      {% if msgs %}
        <div style="display:grid;gap:.5rem;max-width:1100px;margin:0 auto">
          {% for cat, msg in msgs %}
            <div class="flash {{ cat|default('info') }}">{{ msg }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
  </section>

  <main>
    {% block content %}{% endblock %}
  </main>

  <footer>
    <div style="max-width:1100px;margin:0 auto;display:flex;justify-content:space-between;flex-wrap:wrap;gap:.5rem">
      <div>© {{  now().year if false else '' }} Tighri</div>
      <div><a class="nav-link" href="{{ url_for('site_status') }}">Statut</a></div>
    </div>
  </footer>

  {% block extra_js %}{% endblock %}
</body>
</html>
