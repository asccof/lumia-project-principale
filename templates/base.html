<!doctype html>
<html lang="{{ current_lang }}" dir="{{ text_dir }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>{% block title %}Tighri{% endblock %}</title>
  <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}">
  {% block meta %}{% endblock %}

  <style>
    /* Pas de font-family ici => on ne touche pas à ta police */
    * { box-sizing: border-box; }
    body { margin:0; background:#fff; color:#222; }
    a { color:inherit; text-decoration:none; }
    header.site-top {
      border-bottom:1px solid #eee; background:#fff;
    }
    .container { max-width:1200px; margin:0 auto; padding:0 16px; }
    .navbar {
      display:flex; align-items:center; justify-content:space-between; gap:12px; height:60px;
    }
    .brand { font-weight:700; }
    .nav-links { display:flex; gap:14px; align-items:center; flex-wrap:wrap; }
    .nav-links a { padding:6px 10px; border-radius:8px; }
    .nav-links a:hover { background:#f3f3f7; }
    .spacer { flex:1; }
    .lang-form { display:flex; align-items:center; gap:6px; }
    .lang-select { padding:6px 8px; border-radius:8px; border:1px solid #e5e5ef; background:#fff; }
    main { min-height:60vh; }
    footer { border-top:1px solid #eee; padding:24px 0; color:#666; background:#fafafa; }
  </style>

  {% block extra_head %}{% endblock %}
  {% block extra_css %}{% endblock %}
</head>
<body>
  <header class="site-top">
    <div class="container">
      <nav class="navbar" aria-label="Navigation principale">
        <a class="brand" href="{{ url_for('index') }}">Tighri</a>

        <div class="nav-links" role="menubar">
          <a role="menuitem" href="{{ url_for('index') }}">{{ t('nav.home','Accueil') }}</a>
          <a role="menuitem" href="{{ url_for('professionals') }}">{{ t('nav.professionals','Professionnels') }}</a>
          <a role="menuitem" href="{{ url_for('anthecc') }}">{{ t('nav.anthecc','ANTHECC') }}</a>
          <a role="menuitem" href="{{ url_for('about') }}">{{ t('nav.about','À propos') }}</a>
          <a role="menuitem" href="{{ url_for('contact') }}">{{ t('nav.contact','Contact') }}</a>
          <a role="menuitem" href="{{ url_for('site_status') }}">{{ t('nav.status','Statut') }}</a>
          {% if current_user.is_authenticated %}
            {% if current_user.user_type == 'professional' %}
              <a role="menuitem" href="{{ url_for('professional_dashboard') }}">Mon espace</a>
            {% else %}
              <a role="menuitem" href="{{ url_for('my_appointments') }}">Mes rendez-vous</a>
            {% endif %}
            <a role="menuitem" href="{{ url_for('logout') }}">{{ t('auth.logout','Déconnexion') }}</a>
          {% else %}
            <a role="menuitem" href="{{ url_for('login') }}">{{ t('auth.login','Connexion') }}</a>
            <a role="menuitem" href="{{ url_for('register') }}">{{ t('auth.register','Inscription') }}</a>
            <a role="menuitem" href="{{ url_for('professional_register') }}">Espace Pro</a>
          {% endif %}
          {% if current_user.is_authenticated and (current_user.is_admin is defined and current_user.is_admin) %}
            <a role="menuitem" href="/admin/">Admin</a>
          {% endif %}
        </div>

        <div class="spacer"></div>

        <!-- Sélecteur de langue sans JS, ne change pas la police -->
        <form class="lang-form" action="{{ url_for('set_language_qs') }}" method="get">
          <label for="lang" style="font-size:.9rem; color:#666;">{{ current_lang_label }}</label>
          <select id="lang" name="lang" class="lang-select" onchange="this.form.submit()">
            <option value="fr" {{ 'selected' if current_lang=='fr' else '' }}>Français</option>
            <option value="en" {{ 'selected' if current_lang=='en' else '' }}>English</option>
            <option value="ar" {{ 'selected' if current_lang=='ar' else '' }}>العربية</option>
          </select>
        </form>
      </nav>
    </div>
  </header>

  <main class="container">
    {% block content %}{% endblock %}
  </main>

  <footer>
    <div class="container">
      <div>Tous droits réservés © {{  now().year if false else '' }} Tighri</div>
      <div style="margin-top:6px;">
        <a href="{{ url_for('about') }}">À propos</a> ·
        <a href="{{ url_for('contact') }}">Contact</a> ·
        <a href="{{ url_for('site_status') }}">Statut</a>
      </div>
    </div>
  </footer>

  {% block extra_js %}{% endblock %}
  {% block scripts_end %}{% endblock %}
</body>
</html>
