{% extends "base.html" %}
{% block title %}Mettre à jour mes photos{% endblock %}

{% block content %}
<div class="container py-4">
  <h1 class="h5 mb-3">Mes photos (jusqu’à 3)</h1>

  <form method="post" enctype="multipart/form-data">
    {% if csrf_token is defined %}<input type="hidden" name="csrf_token" value="{{ csrf_token() }}">{% endif %}

    <div class="row g-4">

      <!-- Photo principale -->
      <div class="col-md-4">
        <label class="form-label">Photo 1 (principale)</label>
        <div class="mb-2">
          <img id="pv1" src="{{ professional.image_url or url_for('profile_photo', professional_id=professional.id) }}"
               alt="Aperçu 1" style="width:100%;max-width:260px;height:260px;object-fit:cover;border-radius:12px;border:1px solid #eee">
        </div>
        <input class="form-control" type="file" name="photo" accept=".jpg,.jpeg,.png,.gif" onchange="previewFile(this,'pv1')">
        <div class="form-text">Carré conseillé ~512×512</div>
      </div>

      <!-- Photo 2 -->
      <div class="col-md-4">
        <label class="form-label">Photo 2</label>
        <div class="mb-2">
          <img id="pv2" src="{{ professional.image_url2 or 'https://placehold.co/260x260?text=Photo+2' }}"
               alt="Aperçu 2" style="width:100%;max-width:260px;height:260px;object-fit:cover;border-radius:12px;border:1px solid #eee">
        </div>
        <input class="form-control" type="file" name="photo2" accept=".jpg,.jpeg,.png,.gif" onchange="previewFile(this,'pv2')">
      </div>

      <!-- Photo 3 -->
      <div class="col-md-4">
        <label class="form-label">Photo 3</label>
        <div class="mb-2">
          <img id="pv3" src="{{ professional.image_url3 or 'https://placehold.co/260x260?text=Photo+3' }}"
               alt="Aperçu 3" style="width:100%;max-width:260px;height:260px;object-fit:cover;border-radius:12px;border:1px solid #eee">
        </div>
        <input class="form-control" type="file" name="photo3" accept=".jpg,.jpeg,.png,.gif" onchange="previewFile(this,'pv3')">
      </div>

    </div>

    <div class="mt-4 d-flex gap-2">
      <button class="btn btn-primary" type="submit">Enregistrer</button>
      <a class="btn btn-outline-secondary" href="{{ url_for('professional_edit_profile') }}">Retour au profil</a>
    </div>
  </form>
</div>

<script>
  function previewFile(input, imgId){
    const file = input.files && input.files[0];
    const img = document.getElementById(imgId);
    if (!file || !img) return;
    const reader = new FileReader();
    reader.onload = e => { img.src = e.target.result; };
    reader.readAsDataURL(file);
  }
</script>
{% endblock %}
