<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Admin · Disponibilités — {{ professional.name }}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h5 mb-0">Disponibilités · {{ professional.name }}</h1>
    <div>
      <a class="btn btn-outline-secondary" href="{{ url_for('admin.admin_professionals') }}">← Liste</a>
      <a class="btn btn-outline-primary" href="{{ url_for('admin.view_professional', professional_id=professional.id) }}">Voir le profil</a>
    </div>
  </div>

  <form method="post">
    {% if csrf_token is defined %}<input type="hidden" name="csrf_token" value="{{ csrf_token() }}">{% endif %}

    <div class="table-responsive">
      <table class="table table-sm align-middle">
        <thead>
          <tr>
            <th>Jour</th>
            <th>Plage 1</th>
            <th>Plage 2</th>
            <th>Plage 3</th>
          </tr>
        </thead>
        <tbody>
          {% set days = ['Lundi','Mardi','Mercredi','Jeudi','Vendredi','Samedi','Dimanche'] %}
          {% for d in range(7) %}
          {% set w = windows_by_day.get(d, []) %}
          <tr>
            <td class="fw-bold">{{ days[d] }}</td>
            <td>
              <div class="form-check mb-1">
                <input class="form-check-input" type="checkbox" name="available_{{ d }}" id="a{{d}}" {% if w|length >= 1 %}checked{% endif %}>
                <label class="form-check-label" for="a{{d}}">Actif</label>
              </div>
              <div class="input-group input-group-sm">
                <input class="form-control" name="start_time_{{ d }}" placeholder="08:00" value="{{ w[0].start_time if w|length>=1 else '' }}">
                <span class="input-group-text">→</span>
                <input class="form-control" name="end_time_{{ d }}" placeholder="12:00" value="{{ w[0].end_time if w|length>=1 else '' }}">
              </div>
            </td>
            <td>
              <div class="form-check mb-1">
                <input class="form-check-input" type="checkbox" name="available_{{ d }}_2" id="a{{d}}_2" {% if w|length >= 2 %}checked{% endif %}>
                <label class="form-check-label" for="a{{d}}_2">Actif</label>
              </div>
              <div class="input-group input-group-sm">
                <input class="form-control" name="start_time_{{ d }}_2" placeholder="13:00" value="{{ w[1].start_time if w|length>=2 else '' }}">
                <span class="input-group-text">→</span>
                <input class="form-control" name="end_time_{{ d }}_2" placeholder="16:00" value="{{ w[1].end_time if w|length>=2 else '' }}">
              </div>
            </td>
            <td>
              <div class="form-check mb-1">
                <input class="form-check-input" type="checkbox" name="available_{{ d }}_3" id="a{{d}}_3" {% if w|length >= 3 %}checked{% endif %}>
                <label class="form-check-label" for="a{{d}}_3">Actif</label>
              </div>
              <div class="input-group input-group-sm">
                <input class="form-control" name="start_time_{{ d }}_3" placeholder="16:30" value="{{ w[2].start_time if w|length>=3 else '' }}">
                <span class="input-group-text">→</span>
                <input class="form-control" name="end_time_{{ d }}_3" placeholder="19:00" value="{{ w[2].end_time if w|length>=3 else '' }}">
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <button class="btn btn-primary mt-2">Enregistrer</button>
  </form>
</div>
</body>
</html>
