{% extends "base.html" %}
{% block title %}Espace Professionnel – Tighri{% endblock %}

{% block extra_css %}
<style>
  :root{--primary:#8B5CF6;--primary-dark:#6D28D9;--ink:#2d1a47;--muted:#4B3869;--bg:#f7f5fa;--card:#fff;--shadow:0 2px 12px rgba(139,92,246,.12);--radius:16px}
  .container-pro{max-width:1200px;margin:2rem auto;padding:0 1rem}
  .page-header{background:#fff;border-radius:var(--radius);box-shadow:var(--shadow);padding:clamp(1rem,2.5vw,2rem);margin-bottom:1rem}
  .page-header h1{margin:.25rem 0 .25rem;color:var(--primary)}
  .page-header p{margin:0;color:var(--muted)}
  .grid{display:grid;grid-template-columns:1fr;gap:1rem}
  @media(min-width:760px){.grid{grid-template-columns:repeat(2,minmax(0,1fr))}}
  @media(min-width:1024px){.grid{grid-template-columns:repeat(3,minmax(0,1fr))}}
  .card{background:#fff;border-radius:var(--radius);box-shadow:var(--shadow);padding:1rem;display:grid;gap:.5rem}
  .card h3{margin:.25rem 0}
  .card p{margin:0;color:var(--muted)}
  .actions{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:.5rem}
  .btn-pill{display:inline-block;text-decoration:none;text-align:center;font-weight:700;padding:.7rem 1rem;border-radius:999px}
  .btn-outline{color:var(--primary);border:2px solid var(--primary);background:#fff}
  .btn-outline:hover{background:#f4edff}
  .btn-solid{background:var(--primary);color:#fff;border:2px solid var(--primary)}
  .btn-solid:hover{background:var(--primary-dark);border-color:var(--primary-dark)}
  .thumbs{display:grid;grid-template-columns:repeat(3,1fr);gap:.5rem;margin-top:.25rem}
  .thumb{aspect-ratio:1/1;border-radius:12px;overflow:hidden;background:#eee}
  .thumb img{width:100%;height:100%;object-fit:cover;display:block}
  .thumb-label{font-size:.85rem;color:var(--muted);margin-top:.25rem;text-align:center}
</style>
{% endblock %}

{% block content %}
<div class="container-pro">
  <div class="page-header">
    <h1>Mon espace professionnel</h1>
    <p>Gérez vos rendez-vous, disponibilités et informations de profil.</p>
  </div>

  <div class="grid">
    <!-- Mes RDV -->
    <section class="card">
      <h3>Mes Rendez-vous</h3>
      <p>Consultez et gérez vos demandes de rendez-vous.</p>
      <div class="actions">
        <a class="btn-pill btn-solid" href="{{ url_for('professional_appointments') }}">Voir mes RDV</a>
      </div>
    </section>

    <!-- Disponibilités -->
    <section class="card">
      <h3>Mes Disponibilités</h3>
      <p>Définissez vos horaires de disponibilité.</p>
      <div class="actions">
        <a class="btn-pill btn-solid" href="{{ url_for('professional_availability') }}">Gérer disponibilités</a>
      </div>
    </section>

    <!-- Indisponibilités -->
    <section class="card">
      <h3>Créneaux Indisponibles</h3>
      <p>Bloquez des dates/heures spécifiques.</p>
      <div class="actions">
        <a class="btn-pill btn-solid" href="{{ url_for('professional_unavailable_slots') }}">Gérer indisponibilités</a>
      </div>
    </section>

    <!-- Profil -->
    <section class="card">
      <h3>Mon Profil</h3>
      <p>Modifiez vos informations professionnelles.</p>
      <div class="actions">
        <a class="btn-pill btn-solid" href="{{ url_for('professional_edit_profile') }}">Modifier mon profil</a>
      </div>
    </section>

   <!-- Mes Photos (aperçu + actions d'upload) -->
<section class="card">
  <h3>Mes Photos</h3>
  <p>Photo principale et 2 photos secondaires (aperçu + téléversement direct).</p>
  {% set u1 = professional_photo_url(professional, 1) %}
  {% set u2 = professional_photo_url(professional, 2) %}
  {% set u3 = professional_photo_url(professional, 3) %}

  <div class="thumbs" aria-label="Aperçu photos">
    <div>
      <div class="thumb">
        <img src="{{ u1 }}" alt="Photo principale"
             onerror="this.onerror=null;this.src='https://placehold.co/300x300?text=Photo';">
      </div>
      <div class="thumb-label">Principale</div>
    </div>
    <div>
      <div class="thumb">
        {% if u2 %}
          <img src="{{ u2 }}" alt="Photo #2" onerror="this.style.display='none'">
        {% else %}
          <img src="https://placehold.co/300x300?text=Aucune" alt="Aucune photo #2">
        {% endif %}
      </div>
      <div class="thumb-label">#2</div>
    </div>
    <div>
      <div class="thumb">
        {% if u3 %}
          <img src="{{ u3 }}" alt="Photo #3" onerror="this.style.display='none'">
        {% else %}
          <img src="https://placehold.co/300x300?text=Aucune" alt="Aucune photo #3">
        {% endif %}
      </div>
      <div class="thumb-label">#3</div>
    </div>
  </div>

  <div class="actions" style="margin-top:.5rem">
    <a class="btn-pill btn-outline" href="{{ url_for('professional_upload_photo') }}">Changer la principale</a>
    <a class="btn-pill btn-outline" href="{{ url_for('professional_upload_photo_n', index=2) }}">Téléverser #2</a>
    <a class="btn-pill btn-outline" href="{{ url_for('professional_upload_photo_n', index=3) }}">Téléverser #3</a>
  </div>
</section>

    <!-- Bureau virtuel -->
    <section class="card">
      <h3>Bureau virtuel</h3>
      <p>Accédez aux dossiers patients, messagerie, exercices & visio.</p>
      <div class="actions">
        <a class="btn-pill btn-solid" href="{{ url_for('pro_office_index') }}">Ouvrir le bureau</a>
      </div>
    </section>

    <!-- Outils (liens rapides) -->
    <section class="card">
      <h3>Outils</h3>
      <p>Accès rapide à vos fonctions quotidiennes.</p>
      <div class="actions">
        <a class="btn-pill btn-outline" href="{{ url_for('pro_list_patients') }}">Mes patients</a>
        <a class="btn-pill btn-outline" href="{{ url_for('pro_library') }}">Ma bibliothèque</a>
        <a class="btn-pill btn-outline" href="{{ url_for('pro_stats') }}">Statistiques</a>
      </div>
    </section>
  </div>
</div>
{% endblock %}
