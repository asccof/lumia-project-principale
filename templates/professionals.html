{% extends "base.html" %}
{% block title %}{{ t('nav.professionals') }} - Tighri{% endblock %}

{% block content %}
  <div style="max-width:1100px;margin:2rem auto;padding:0 1rem">
    <h1 style="margin:.5rem 0 1rem">{{ t('nav.professionals') }}</h1>

    <form method="get" action="{{ url_for('professionals') }}" style="display:flex;gap:.5rem;flex-wrap:wrap;margin-bottom:1rem">
      <input type="text" name="q" value="{{ request.args.get('q','') }}" placeholder="{{ t('search.q') }}" style="padding:.6rem .8rem;border:1px solid #ddd;border-radius:10px;flex:1 1 220px">
      <input type="text" name="city" value="{{ request.args.get('city','') }}" placeholder="{{ t('search.city') }}" style="padding:.6rem .8rem;border:1px solid #ddd;border-radius:10px">
      <input type="text" name="specialty" value="{{ request.args.get('specialty','') }}" placeholder="{{ t('search.specialty') }}" style="padding:.6rem .8rem;border:1px solid #ddd;border-radius:10px">
      <select name="mode" style="padding:.6rem .8rem;border:1px solid #ddd;border-radius:10px">
        <option value="">{{ t('search.mode') }}</option>
        {% set mode = request.args.get('mode','') %}
        <option value="cabinet" {{ 'selected' if mode=='cabinet' else '' }}>Cabinet</option>
        <option value="visio"   {{ 'selected' if mode=='visio'   else '' }}>Visio</option>
        <option value="domicile"{{ 'selected' if mode=='domicile'else '' }}>Domicile</option>
      </select>
      <button type="submit" style="padding:.6rem 1rem;border:0;background:#8B5CF6;color:#fff;border-radius:10px">{{ t('search.cta') }}</button>
    </form>

    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:1rem">
      {% for p in professionals %}
        <article style="background:#fff;border:1px solid #eee;border-radius:14px;padding:1rem">
          <div style="display:flex;gap:.8rem;align-items:center">
            <img src="{{ url_for('profile_photo', professional_id=p.id) }}" alt="Photo de {{ p.name|e }}" width="64" height="64" style="border-radius:50%;object-fit:cover">
            <div>
              <div style="display:flex;gap:.5rem;align-items:center;flex-wrap:wrap">
                <strong style="color:#6D28D9">{{ p.name }}</strong>
                <div class="badges">
                  {% if p.is_tighri_certified %}
                    <span class="badge badge-tighri" title="{{ t('badge.tighri') }}">üõ°Ô∏è <i>{{ t('badge.tighri_short') }}</i></span>
                  {% endif %}
                  {% if p.is_anthecc_certified %}
                    <span class="badge badge-anthecc" title="{{ t('badge.anthecc') }}">üèÖ <i>{{ t('badge.anthecc_short') }}</i></span>
                  {% endif %}
                </div>
              </div>
              <div style="color:#4B3869;font-size:.95rem">
                {% if p.specialty %}{{ p.specialty }}
                {% elif p.primary_specialty %}{{ p.primary_specialty.name }}
                {% else %}‚Äî{% endif %}
              </div>
            </div>
          </div>
          {% if p.description %}
            <p style="margin:.6rem 0 0;color:#4B3869">{{ p.description[:110] }}{% if p.description|length>110 %}‚Ä¶{% endif %}</p>
          {% endif %}
          <p style="margin:.7rem 0 0">
            <a href="{{ url_for('professional_detail', professional_id=p.id) }}" style="color:#8B5CF6;font-weight:600">Voir le profil</a>
          </p>
        </article>
      {% else %}
        <p>Aucun professionnel trouv√©.</p>
      {% endfor %}
    </div>
  </div>
{% endblock %}
