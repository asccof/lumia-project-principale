{% extends "base.html" %}
{% block title %}Profil ‚Äì {{ professional.name }}{% endblock %}

{% block extra_css %}
<style>
  :root{
    --primary:#8B5CF6; --primary-dark:#6D28D9;
    --ink:#2d1a47; --muted:#4B3869; --bg:#f7f5fa; --card:#fff;
    --shadow:0 2px 12px rgba(139,92,246,0.1); --radius:18px;
  }
  body{background:var(--bg);color:var(--ink)}
  .wrap{max-width:1100px;margin:2rem auto;padding:0 1rem}
  .top{display:grid;grid-template-columns:260px 1fr;gap:1.25rem;align-items:start}
  @media (max-width:820px){ .top{grid-template-columns:1fr} }

  .card{background:#fff;border-radius:14px;box-shadow:var(--shadow);padding:1.25rem}
  .photo{width:220px;height:220px;border-radius:14px;overflow:hidden;background:#eee;margin:0 auto}
  .photo img{width:100%;height:100%;object-fit:cover;display:block}
  .name{margin:.25rem 0 .35rem;color:#6D28D9}
  .meta{color:#4B3869;opacity:.95}
  .badges{display:flex;flex-wrap:wrap;gap:.45rem;margin:.5rem 0 0}
  .b{display:inline-flex;align-items:center;gap:.35rem;padding:.2rem .55rem;border-radius:999px;font-size:.78rem;font-weight:700;background:#fff;border:1.5px solid #e8e0ff}
  .b svg{width:16px;height:16px}
  .b-tighri{border-color:#8B5CF6}
  .b-anthecc{border-color:#10b981}

  .actions{display:flex;flex-wrap:wrap;gap:.6rem;margin-top:1rem}
  .btn{display:inline-block;background:var(--primary);color:#fff;text-decoration:none;border:none;border-radius:999px;padding:.7rem 1.2rem;font-weight:700}
  .btn:hover{background:var(--primary-dark)}
  .btn-alt{background:#fff;color:#6D28D9;border:2px solid #e6dcff}

  .section{margin-top:1rem}
  .section h2{margin:.2rem 0 .6rem;color:#6D28D9;font-size:1.2rem}
  .box{background:#fff;border-radius:14px;box-shadow:var(--shadow);padding:1rem}
  .list{display:flex;flex-wrap:wrap;gap:.5rem}
  .pill{background:#f4f0ff;border:1px solid #e6dcff;border-radius:999px;padding:.25rem .6rem;font-size:.85rem}
  .social{display:flex;gap:.6rem;flex-wrap:wrap}
  .social a{color:var(--primary);text-decoration:none}
  .social a:hover{text-decoration:underline}
</style>
{% endblock %}

{% block content %}
<div class="wrap">
  <div class="top">
    <aside class="card">
      <div class="photo">
        <img src="{{ url_for('profile_photo', professional_id=professional.id) }}"
             alt="Photo de {{ professional.name|e }}"
             width="220" height="220" loading="lazy"
             onerror="this.onerror=null;this.src='https://placehold.co/500x500?text=Photo';">
      </div>
    </aside>

    <section class="card">
      {% set tighri  = professional.is_certified_tighri|default(professional.tighri_certified|default(false)) %}
      {% set anthecc = professional.is_certified_anthecc|default(professional.anthecc_certified|default(false)) %}

      <h1 class="name">{{ professional.name }}</h1>
      <div class="meta">
        {% if professional.specialty %}{{ professional.specialty }}
        {% elif professional.primary_specialty %}{{ professional.primary_specialty.name }}
        {% else %}Professionnel{% endif %}
        {% if professional.location %} ¬∑ {{ professional.location }}{% endif %}
        {% if professional.experience_years %} ¬∑ {{ professional.experience_years }} ans d'exp√©rience{% endif %}
        {% if professional.consultation_fee %} ¬∑ {{ professional.consultation_fee }} MAD{% endif %}
      </div>

      <div class="badges">
        {% if tighri %}
          <span class="b b-tighri" title="Certifi√© Tighri">
            <svg viewBox="0 0 24 24" fill="none"><path d="M20 7l-9 9-5-5" stroke="#8B5CF6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            Certifi√© Tighri
          </span>
        {% endif %}
        {% if anthecc %}
          <span class="b b-anthecc" title="Certifi√© ANTHECC">
            <svg viewBox="0 0 24 24" fill="none"><path d="M12 3l3 6 6 .9-4.5 4.3 1.1 6.5L12 17l-5.6 3.7 1.1-6.5L3 9.9 9 9z" stroke="#10b981" stroke-width="1.6" stroke-linejoin="round"/></svg>
            Certifi√© ANTHECC
          </span>
        {% endif %}
      </div>

      <div class="actions">
        <a class="btn" href="{{ url_for('book_appointment', professional_id=professional.id) }}">R√©server un rendez-vous</a>
        {% if professional.phone %}
          <a class="btn btn-alt" href="tel:{{ professional.phone|replace(' ','')|replace('.','') }}">Appeler</a>
        {% endif %}
      </div>
    </section>
  </div>

  <div class="section">
    <h2>Pr√©sentation</h2>
    <div class="box">
      {% set d = professional.description or 'Profil en cours de compl√©tion.' %}
      <p style="margin:.2rem 0 0;color:#4B3869;line-height:1.75">{{ d }}</p>
    </div>
  </div>

  <div class="section" style="display:grid;grid-template-columns:1fr 1fr;gap:1rem">
    <div class="box">
      <h2>Informations</h2>
      <div class="list" style="color:#4B3869">
        {% if professional.address %}<div class="pill">üìç {{ professional.address }}</div>{% endif %}
        {% if professional.consultation_types %}
          {% for ct in professional.consultation_types.split(',') %}
            {% if ct %}<div class="pill">{{ ct|capitalize }}</div>{% endif %}
          {% endfor %}
        {% endif %}
        {% if professional.consultation_duration_minutes %}<div class="pill">‚è± {{ professional.consultation_duration_minutes }} min</div>{% endif %}
        {% if professional.buffer_between_appointments_minutes %}<div class="pill">‚ûï Pause {{ professional.buffer_between_appointments_minutes }} min</div>{% endif %}
      </div>
    </div>

    <div class="box">
      <h2>R√©seaux</h2>
      <div class="social">
        {% if professional.facebook_url  %}<a href="{{ professional.facebook_url  }}" target="_blank" rel="noopener">Facebook</a>{% endif %}
        {% if professional.instagram_url %}<a href="{{ professional.instagram_url }}" target="_blank" rel="noopener">Instagram</a>{% endif %}
        {% if professional.tiktok_url    %}<a href="{{ professional.tiktok_url    }}" target="_blank" rel="noopener">TikTok</a>{% endif %}
        {% if professional.youtube_url   %}<a href="{{ professional.youtube_url   }}" target="_blank" rel="noopener">YouTube</a>{% endif %}
        {% if not (professional.facebook_url or professional.instagram_url or professional.tiktok_url or professional.youtube_url) %}
          <span style="color:#6b5a82">Aucun lien pour le moment.</span>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="section">
    <h2>R√©server</h2>
    <div class="box" style="display:flex;align-items:center;justify-content:space-between;gap:1rem;flex-wrap:wrap">
      <div style="color:#4B3869">Choisissez une date sur la page de r√©servation pour voir les cr√©neaux disponibles.</div>
      <a class="btn" href="{{ url_for('book_appointment', professional_id=professional.id) }}">Aller √† la r√©servation</a>
    </div>
  </div>
</div>
{% endblock %}
