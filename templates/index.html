{% extends "base.html" %}
{% block title %}Tighri - Prendre rendez-vous avec un professionnel{% endblock %}

{% block extra_css %}
<style>
  :root{
    --primary:#8B5CF6; --primary-dark:#6D28D9;
    --ink:#2d1a47; --muted:#4B3869; --bg:#f7f5fa; --card:#fff;
    --shadow:0 2px 12px rgba(139,92,246,0.1); --radius:18px;
  }
  body{background:var(--bg);color:var(--ink)}
  header{background:linear-gradient(90deg, var(--primary) 0%, var(--primary-dark) 100%);color:#fff;
    padding:8rem 0 2rem;margin-top:0;text-align:center}
  header h1{margin:0 0 .5rem;font-size:3rem;font-weight:700}
  header p{margin:0 auto 1.5rem;max-width:600px;font-size:1.2rem;opacity:.95}

  .search-bar{display:flex;justify-content:center;margin:2rem 0 1rem}
  .search-bar input{width:400px;padding:1rem 1.25rem;border:1.5px solid var(--primary);border-radius:30px 0 0 30px;font-size:1rem;outline:none;background:#fff}
  .search-bar button{padding:1rem 1.5rem;border:none;background:var(--primary);color:#fff;font-size:1rem;border-radius:0 30px 30px 0;cursor:pointer;font-weight:700}
  .search-bar button:hover{background:var(--primary-dark)}

  .sections{display:flex;flex-wrap:wrap;justify-content:center;gap:2rem;margin:3rem 0;padding:0 2rem}
  .section{background:#fff;border-radius:18px;box-shadow:var(--shadow);padding:2.5rem;min-width:320px;max-width:400px;flex:1 1 320px;text-align:center}
  .section h2{color:var(--primary);margin:0 0 1rem}
  .section p{color:var(--muted);margin:0 0 1.5rem}
  .section a{display:inline-block;background:var(--primary);color:#fff;padding:1rem 2rem;border-radius:30px;text-decoration:none;font-weight:700}
  .section a:hover{background:var(--primary-dark)}

  .featured{max-width:1200px;margin:0 auto 4rem;padding:0 2rem}
  .featured h3{color:#6D28D9;margin:0 0 2rem;text-align:center;font-size:2rem}
  .professionals{display:flex;flex-wrap:wrap;gap:2rem;justify-content:center}
  .professional-card{background:#fff;border-radius:14px;box-shadow:0 2px 8px rgba(139,92,246,0.08);padding:1.5rem;min-width:280px;max-width:320px;flex:1 1 280px;text-align:center}

  .professional-card .avatar-box{width:96px;height:96px;border-radius:50%;overflow:hidden;background:#eee;margin:0 auto .85rem}
  .professional-card .avatar-img{width:100%;height:100%;object-fit:cover;object-position:center;display:block}
  .professional-card h4{margin:.5rem 0 .2rem;color:#6D28D9}
  .professional-card p{color:#4B3869;font-size:.95rem;margin:.35rem 0}
  .professional-card a{color:var(--primary);text-decoration:none;font-weight:600}
  .professional-card a:hover{text-decoration:underline}

  .about-section{background:#fff;padding:4rem 2rem;margin:3rem 0}
  .about-container{max-width:1200px;margin:0 auto;text-align:center}
  .about-section h2{color:var(--primary);font-size:2.2rem;margin:0 0 1rem}
  .about-section p{color:var(--muted);font-size:1.05rem;line-height:1.8;max-width:800px;margin:0 auto 1.25rem}

  .services-section{padding:4rem 2rem;background:var(--bg)}
  .services-container{max-width:1200px;margin:0 auto}
  .services-section h2{color:var(--primary);font-size:2.2rem;text-align:center;margin:0 0 2rem}
  .services-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1.25rem}
  .service-card{background:#fff;padding:2rem;border-radius:14px;box-shadow:0 2px 8px rgba(139,92,246,0.08);text-align:center}
  .service-card h3{color:#6D28D9;margin:.25rem 0 1rem}
  .service-card p{color:var(--muted);margin:0}

  .contact-section{background:var(--primary);color:#fff;padding:4rem 2rem;text-align:center}
  .contact-container{max-width:800px;margin:0 auto}
  .contact-section h2{font-size:2rem;margin:0 0 1rem}
  .contact-section p{font-size:1.05rem;margin:0 0 1.25rem;opacity:.95}
  .contact-info{display:flex;justify-content:center;gap:2rem;flex-wrap:wrap}
  .contact-item{display:flex;flex-direction:column;align-items:center;gap:.35rem}
  .contact-item strong{font-size:1.05rem}
  .contact-actions{display:flex;gap:1rem;flex-wrap:wrap;justify-content:center;margin-top:1.25rem}
  .contact-btn{display:inline-flex;align-items:center;gap:.5rem;background:#ffffff;color:#6D28D9;border:2px solid #ffffff;
    padding:.8rem 1.2rem;border-radius:999px;text-decoration:none;font-weight:700;box-shadow:0 2px 8px rgba(139,92,246,0.18);transition:.2s}
  .contact-btn:hover{transform:translateY(-2px);background:#f1e9ff;border-color:#8B5CF6}
  .contact-badge{display:inline-block;font-weight:700;padding:.3rem .7rem;border-radius:999px;background:#ffffff20;border:1px solid #ffffff50}

  @media (max-width:768px){
    header{padding:6.5rem 1rem 2rem}
    header h1{font-size:2rem}
    .search-bar{flex-direction:column;align-items:stretch;padding:0 1rem;gap:.5rem}
    .search-bar input,.search-bar button{width:100%;border-radius:12px}
    .sections{flex-direction:column;align-items:center;padding:0 1rem;gap:1rem;margin:2rem 0}
    .featured{padding:0 1rem}
    .professionals{gap:1rem}
    .professional-card .avatar-box{width:84px;height:84px}
    .about-section,.services-section{padding:2rem 1rem;margin:2rem 0}
    .services-grid{grid-template-columns:1fr}
    .contact-section{padding:2rem 1rem}
  }
</style>
{% endblock %}

{% block content %}
  <!-- HEADER -->
  <header id="top">
    <h1>Tighri</h1>
    <p>La plateforme marocaine pour prendre rendez-vous avec des psychologues, thérapeutes et coachs certifiés</p>
  </header>

  <!-- SEARCH -->
  <form class="search-bar" method="get" action="{{ url_for('professionals') }}">
    <input type="text" name="q" placeholder="Rechercher un professionnel, une spécialité, une ville...">
    <button type="submit">Rechercher</button>
  </form>

  <!-- 2 BLOCS -->
  <div class="sections">
    <div class="section">
      <h2>Espace Patient</h2>
      <p>Consultez les profils, prenez rendez-vous en cabinet, à domicile ou en vidéo avec des professionnels certifiés.</p>
      <a href="{{ url_for('register') }}">Je suis patient</a>
    </div>
    <div class="section">
      <h2>Espace Professionnel</h2>
      <p>Rejoignez Tighri pour proposer vos services et gérer vos rendez-vous en toute simplicité.</p>
      <a href="{{ url_for('professional_register') }}">Je suis professionnel</a>
    </div>
  </div>

  <!-- PROFESSIONNELS EN VEDETTE -->
  <div class="featured">
    <h3>Professionnels en vedette</h3>
    <div class="professionals">
      {% for professional in professionals %}
        <div class="professional-card">
          <div class="avatar-box">
            <picture>
              <source type="image/webp"
                      srcset="
                        {{ url_for('avatar', professional_id=professional.id, s=96,  f='webp', v=professional.updated_at|default(0)) }} 96w,
                        {{ url_for('avatar', professional_id=professional.id, s=192, f='webp', v=professional.updated_at|default(0)) }} 192w,
                        {{ url_for('avatar', professional_id=professional.id, s=384, f='webp', v=professional.updated_at|default(0)) }} 384w">
              <source type="image/jpeg"
                      srcset="
                        {{ url_for('avatar', professional_id=professional.id, s=96,  f='jpg', v=professional.updated_at|default(0)) }} 96w,
                        {{ url_for('avatar', professional_id=professional.id, s=192, f='jpg', v=professional.updated_at|default(0)) }} 192w,
                        {{ url_for('avatar', professional_id=professional.id, s=384, f='jpg', v=professional.updated_at|default(0)) }} 384w">
              <img
                class="avatar-img"
                src="{{ url_for('avatar', professional_id=professional.id, s=96, f='jpg', v=professional.updated_at|default(0)) }}"
                alt="Photo de {{ professional.name|e }}"
                width="96" height="96"
                loading="lazy" decoding="async" fetchpriority="low">
            </picture>
          </div>

          <h4>{{ professional.name }}</h4>
          <p>{{ professional.specialty }}</p>
          <p>
            {% set d = professional.description or '' %}
            {{ d[:80] }}{% if d|length > 80 %}…{% endif %}
          </p>
          <a href="{{ url_for('professional_detail', professional_id=professional.id) }}">Voir le profil</a>
        </div>
      {% endfor %}
    </div>
  </div>

  <!-- À PROPOS -->
  <section id="about" class="about-section">
    <div class="about-container">
      <h2>À propos de Tighri</h2>
      <p>Tighri est la première plateforme marocaine dédiée à la santé mentale et au bien-être. Nous connectons patients et professionnels pour faciliter l'accès à des soins psychologiques de qualité.</p>
      <p>Notre mission est de démocratiser l'accès aux services de santé mentale au Maroc, dans un environnement de confiance et de sécurité.</p>
    </div>
  </section>

  <!-- SERVICES -->
  <section id="services" class="services-section">
    <div class="services-container">
      <h2>Nos Services</h2>
      <div class="services-grid">
        <div class="service-card">
          <h3>Consultations en Cabinet</h3>
          <p>Rencontrez des professionnels dans leur cabinet pour des séances en face à face.</p>
        </div>
        <div class="service-card">
          <h3>Consultations à Domicile</h3>
          <p>Certains professionnels se déplacent à votre domicile pour plus de confort.</p>
        </div>
        <div class="service-card">
          <h3>Consultations en Vidéo</h3>
          <p>Consultez en ligne en toute sécurité depuis chez vous.</p>
        </div>
        <div class="service-card">
          <h3>Gestion de Planning</h3>
          <p>Réservez vos créneaux et recevez des rappels automatiques.</p>
        </div>
        <div class="service-card">
          <h3>Profils Vérifiés</h3>
          <p>Les diplômes et identités sont vérifiés par notre équipe.</p>
        </div>
        <div class="service-card">
          <h3>Support 24/7</h3>
          <p>Nous vous accompagnons à chaque étape de votre parcours.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- CONTACT -->
  <section id="contact" class="contact-section">
    <div class="contact-container">
      <h2>Nous contacter</h2>
      <p><strong>Bienvenue au Centre d'écoute et de conseil Tighri.</strong><br>Besoin d'aide ou de conseils gratuits ? Contactez-nous.</p>

      <div class="contact-info" style="margin-top:1rem;">
        <div class="contact-item">
          <strong>Email</strong>
          <span>contact@tighri.ma</span>
        </div>
        <div class="contact-item">
          <strong>Téléphone</strong>
          <span>06 63 40 01 90</span>
        </div>
        <div class="contact-item">
          <strong>WhatsApp</strong>
          <span class="contact-badge">Disponible</span>
        </div>
      </div>

      <div class="contact-actions">
        <a class="contact-btn" href="mailto:contact@tighri.ma?subject=Contact%20Tighri&body=Bonjour%20Tighri%2C">
          ✉️ Contacter par e-mail
        </a>
        <a class="contact-btn" href="tel:+212663400190">
          📞 Appeler le <span>06 63 40 01 90</span>
        </a>
        <a class="contact-btn" target="_blank" rel="noopener"
           href="https://wa.me/212663400190?text=Bonjour%20Tighri%2C%20j%E2%80%99ai%20besoin%20d%E2%80%99aide%20et%20de%20conseils.">
          💬 WhatsApp direct
        </a>
      </div>
    </div>
  </section>
{% endblock %}
