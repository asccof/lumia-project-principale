<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#8B5CF6" />
  <title>Tighri — Prendre rendez-vous avec un professionnel</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --primary:#8B5CF6;
      --primary-dark:#6D28D9;
      --ink:#2d1a47;
      --muted:#4B3869;
      --bg:#f7f5fa;
      --card:#ffffff;
      --shadow:0 2px 12px rgba(139,92,246,.12);
      --radius:18px;
      --nav-h:64px;
    }

    /* Reset de base + mobile-first */
    *{box-sizing:border-box}
    html,body{margin:0;padding:0}
    body{
      font-family:'Montserrat',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--ink);
      background:var(--bg);
      line-height:1.45;
      padding-top:var(--nav-h); /* évite que le header passe sous la navbar fixe */
    }
    img{max-width:100%;display:block}
    a{color:inherit}

    /* NAVBAR */
    .navbar{
      position:fixed; inset:0 0 auto 0; height:var(--nav-h);
      background:rgba(255,255,255,.98);
      backdrop-filter:saturate(140%) blur(10px);
      border-bottom:1px solid rgba(139,92,246,.12);
      z-index:1000;
    }
    .nav-inner{
      height:100%; max-width:1200px; margin:0 auto;
      display:flex; align-items:center; justify-content:space-between;
      padding:0 .75rem;
    }
    .brand{
      display:flex; align-items:center; gap:.5rem; text-decoration:none;
      color:var(--primary); font-weight:700; font-size:1.25rem;
    }

    /* Menu */
    .nav-right{display:flex; align-items:center; gap:1rem}
    .nav-links{
      display:none;           /* mobile: masqué par défaut */
      position:fixed; top:var(--nav-h); left:0; right:0;
      background:#fff; border-bottom:1px solid rgba(139,92,246,.12);
      box-shadow:var(--shadow);
    }
    .nav-links.open{display:block}
    .nav-list{
      list-style:none; margin:0; padding:.5rem .75rem;
      display:grid; gap:.25rem;
    }
    .nav-list a{
      display:block; padding:.65rem .75rem; border-radius:10px;
      text-decoration:none; font-weight:600; color:var(--muted);
    }
    .nav-list a:hover{background:#f2ecff; color:var(--primary)}

    .auth{
      display:none; /* visibles dans le panneau mobile */
      padding: .5rem .75rem .75rem;
      display:grid; gap:.5rem;
    }
    .btn{
      display:inline-block; text-decoration:none; font-weight:700; text-align:center;
      padding:.6rem 1rem; border-radius:999px;
    }
    .btn-outline{
      color:var(--primary); border:2px solid var(--primary); background:#fff;
    }
    .btn-outline:hover{background:#f4edff}
    .btn-solid{
      background:var(--primary); color:#fff; border:2px solid var(--primary);
    }
    .btn-solid:hover{background:var(--primary-dark); border-color:var(--primary-dark)}

    /* Burger */
    .burger{
      appearance:none; border:0; background:transparent; padding:.4rem .5rem; border-radius:10px;
    }
    .burger:focus-visible{outline:2px solid var(--primary)}
    .burger svg{width:26px;height:26px;display:block;color:var(--muted)}

    /* DESKTOP navbar */
    @media(min-width:900px){
      .nav-inner{padding:0 1rem}
      .nav-links{
        position:static; display:block; background:transparent; border:0; box-shadow:none;
      }
      .nav-list{grid-auto-flow:column; gap:1rem; padding:0}
      .auth{display:flex; gap:.6rem; padding:0}
      .burger{display:none}
    }

    /* HERO */
    header.hero{
      background:linear-gradient(90deg,var(--primary) 0%, var(--primary-dark) 100%);
      color:#fff; text-align:center;
      padding:clamp(48px,8vw,96px) 1rem clamp(16px,4vw,24px);
    }
    .hero h1{
      margin:0 0 .5rem 0;
      font-size:clamp(1.6rem,4.5vw,3rem);
      font-weight:700;
      letter-spacing:.2px;
    }
    .hero p{
      margin:.25rem auto 0 auto;
      font-size:clamp(.95rem,2.8vw,1.2rem);
      opacity:.95; max-width:680px;
    }

    /* Recherche */
    .search-wrap{display:flex; justify-content:center; padding:1rem}
    .search{
      width:100%; max-width:720px; display:flex; gap:0; background:#fff;
      border:1.5px solid var(--primary); border-radius:999px; overflow:hidden;
      box-shadow:var(--shadow);
    }
    .search input{
      flex:1; padding:.9rem 1rem; border:0; font-size:1rem; min-width:0;
      outline:none;
    }
    .search button{
      border:0; background:var(--primary); color:#fff; font-weight:700;
      padding:.9rem 1.2rem; cursor:pointer;
    }
    .search button:hover{background:var(--primary-dark)}

    /* Sections 2 cartes */
    .sections{
      display:grid; grid-template-columns:1fr; gap:1rem;
      padding:1rem; max-width:1200px; margin:0 auto;
    }
    .section{
      background:#fff; border-radius:var(--radius); box-shadow:var(--shadow);
      padding:1.25rem; text-align:center;
    }
    .section h2{color:var(--primary); margin:.2rem 0 .5rem; font-size:1.25rem}
    .section p{color:var(--muted); margin:.25rem 0 1rem}
    .section a.btn{min-width:60%}
    @media(min-width:700px){
      .sections{grid-template-columns:repeat(2,1fr)}
    }

    /* Featured */
    .featured{padding:1rem; max-width:1200px; margin:0 auto 2rem}
    .featured h3{
      text-align:center; color:var(--primary-dark);
      font-size:clamp(1.25rem,3.6vw,2rem); margin:1rem 0 1.25rem;
    }
    .grid-pro{
      display:grid; grid-template-columns:1fr; gap:1rem;
    }
    @media(min-width:700px){
      .grid-pro{grid-template-columns:repeat(2, minmax(0,1fr))}
    }
    @media(min-width:1024px){
      .grid-pro{grid-template-columns:repeat(3, minmax(0,1fr))}
    }

    .pro-card{
      background:#fff; border-radius:14px; box-shadow:var(--shadow);
      padding:1rem; display:grid; gap:.6rem;
    }
    .pro-top{display:flex; align-items:center; gap:.75rem}
    .pro-top img{
      width:72px; height:72px; border-radius:50%; object-fit:cover;
      border:3px solid var(--primary);
      flex:0 0 72px;
    }
    .pro-name{margin:0; color:var(--primary-dark); font-weight:700}
    .pro-spec{margin:0; color:var(--primary); font-weight:600; font-size:.95rem}
    .pro-loc{margin:0; color:var(--muted); font-size:.95rem}
    .pro-desc{color:var(--muted); font-size:.95rem}
    .line-clamp{
      display:-webkit-box; -webkit-line-clamp:3; -webkit-box-orient:vertical; overflow:hidden;
    }
    .pro-fee{color:var(--primary); font-weight:700}
    .pro-actions{display:flex; gap:.5rem; margin-top:.25rem}
    .pro-actions .btn{flex:1}

    /* About, Services */
    .about, .services{max-width:1200px; margin:0 auto; padding:1rem}
    .card{
      background:#fff; border-radius:var(--radius); box-shadow:var(--shadow);
      padding:clamp(1rem,2.5vw,2rem);
    }
    .about h2, .services h2{
      color:var(--primary); font-size:clamp(1.25rem,3.6vw,2rem); margin:.25rem 0 1rem;
      text-align:center;
    }
    .about p{color:var(--muted); max-width:900px; margin:.5rem auto}
    .services-grid{
      display:grid; grid-template-columns:1fr; gap:1rem;
    }
    .service-card h3{color:var(--primary-dark); margin:.2rem 0 .5rem}
    .service-card p{color:var(--muted); margin:.25rem 0 0}
    @media(min-width:800px){
      .services-grid{grid-template-columns:repeat(3,1fr)}
    }

    /* Contact (votre nouvelle section) */
    .contact-section{
      background:var(--primary); color:#fff; padding:clamp(24px,6vw,48px) 1rem;
      margin-top:1rem;
    }
    .contact-container{max-width:900px;margin:0 auto;text-align:center}
    .contact-container h2{font-size:clamp(1.25rem,3.6vw,2rem);margin:0 0 .5rem}
    .contact-container p{opacity:.95; margin:0 auto 1rem; max-width:780px}
    .contact-info{
      display:grid; grid-template-columns:1fr; gap:1rem; justify-items:center;
    }
    .contact-item strong{font-size:1rem}
    @media(min-width:650px){
      .contact-info{grid-template-columns:repeat(3,1fr)}
    }
    .contact-actions{
      display:flex; gap:.6rem; flex-wrap:wrap; justify-content:center; margin-top:1rem;
    }
    .contact-btn{
      display:inline-flex; align-items:center; gap:.5rem;
      background:#ffffff; color:var(--primary); border:2px solid #ffffff;
      padding:.7rem 1rem; border-radius:999px; text-decoration:none; font-weight:700;
      box-shadow:0 2px 8px rgba(139,92,246,.18); transition:transform .15s ease;
    }
    .contact-btn:hover{ transform:translateY(-2px); background:#f1e9ff; border-color:var(--primary) }
    .contact-badge{
      display:inline-block; font-weight:700; padding:.25rem .6rem; border-radius:999px;
      background:#ffffff20; border:1px solid #ffffff50;
    }

    /* Footer */
    footer{
      background:#2d1a47; color:#fff; text-align:center; padding:20px 12px; margin-top:8px;
      font-size:.95rem;
    }
  </style>
</head>
<body>

  <!-- NAV -->
  <nav class="navbar" role="navigation" aria-label="Navigation principale">
    <div class="nav-inner">
      <a href="{{ url_for('index') }}" class="brand" aria-label="Accueil Tighri">Tighri</a>

      <!-- Bouton burger (mobile) -->
      <button class="burger" aria-label="Ouvrir le menu" aria-controls="mobile-menu" aria-expanded="false" id="burger">
        <!-- icône burger -->
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
             stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
    </div>

    <!-- Panneau mobile -->
    <div class="nav-links" id="mobile-menu">
      <ul class="nav-list">
        <li><a href="#about">À propos</a></li>
        <li><a href="#services">Services</a></li>
        <li><a href="#contact">Contact</a></li>
        <li><a href="{{ url_for('professionals') }}">Professionnels</a></li>
      </ul>
      <div class="auth">
        {% if current_user.is_authenticated %}
          <a class="btn btn-outline" href="{{ url_for('my_appointments') }}">Mes rendez-vous</a>
          <a class="btn btn-solid" href="{{ url_for('logout') }}">Déconnexion</a>
        {% else %}
          <a class="btn btn-outline" href="{{ url_for('login') }}">Se connecter</a>
          <a class="btn btn-solid" href="{{ url_for('register') }}">S'inscrire</a>
        {% endif %}
      </div>
    </div>
  </nav>

  <!-- HERO -->
  <header class="hero">
    <h1>Tighri</h1>
    <p>La plateforme marocaine pour prendre rendez-vous avec des psychologues, thérapeutes et coachs certifiés.</p>
  </header>

  <!-- Recherche -->
  <div class="search-wrap">
    <form class="search" method="get" action="{{ url_for('professionals') }}" role="search" aria-label="Recherche de professionnels">
      <input type="text" name="q" placeholder="Nom, spécialité, ville…" aria-label="Rechercher un professionnel">
      <button type="submit" aria-label="Lancer la recherche">Rechercher</button>
    </form>
  </div>

  <!-- Sections patient/pro -->
  <section class="sections" aria-label="Entrées rapides">
    <div class="section">
      <h2>Espace Patient</h2>
      <p>Consultez les profils et réservez en cabinet, à domicile ou en visioconférence.</p>
      <a class="btn btn-solid" href="{{ url_for('register') }}">Je suis patient</a>
    </div>
    <div class="section">
      <h2>Espace Professionnel</h2>
      <p>Rejoignez Tighri pour proposer vos services et gérer vos rendez-vous.</p>
      <a class="btn btn-solid" href="{{ url_for('professional_register') }}">Je suis professionnel</a>
    </div>
  </section>

  <!-- Featured -->
  <section class="featured" aria-label="Professionnels en vedette">
    <h3>Professionnels en vedette</h3>
    <div class="grid-pro">
      {% for professional in professionals %}
      <article class="pro-card">
        <div class="pro-top">
          <img
            src="{{ professional.image_url or 'https://via.placeholder.com/80x80/8B5CF6/FFFFFF?text=Pro' }}"
            alt="Photo de {{ professional.name|e }}"
            loading="lazy">
          <div>
            <p class="pro-name">{{ professional.name }}</p>
            <p class="pro-spec">{{ professional.specialty }}</p>
            <p class="pro-loc">📍 {{ professional.address or professional.location or '—' }}</p>
          </div>
        </div>
        <p class="pro-desc line-clamp">
          {% set d=professional.description or '' %}
          {{ d[:140] }}{% if d|length > 140 %}…{% endif %}
        </p>
        <p class="pro-fee">{{ '%.0f'|format(professional.consultation_fee or 0) }} MAD / consultation</p>
        <div class="pro-actions">
          <a class="btn btn-outline" href="{{ url_for('professional_detail', professional_id=professional.id) }}">Voir le profil</a>
          <a class="btn btn-solid" href="{{ url_for('book_appointment', professional_id=professional.id) }}">Prendre RDV</a>
        </div>
      </article>
      {% endfor %}
    </div>
  </section>

  <!-- À propos -->
  <section id="about" class="about">
    <div class="card">
      <h2>À propos de Tighri</h2>
      <p>Tighri est la première plateforme marocaine dédiée à la santé mentale et au bien-être.
         Nous connectons patients et professionnels pour faciliter l’accès à des soins de qualité.</p>
      <p>Notre mission : démocratiser l’accès aux services de santé mentale au Maroc, en
         proposant un cadre fiable et sécurisé.</p>
    </div>
  </section>

  <!-- Services -->
  <section id="services" class="services">
    <div class="card">
      <h2>Nos services</h2>
      <div class="services-grid">
        <div class="service-card">
          <h3>Consultations en Cabinet</h3>
          <p>Des séances en face à face dans le cabinet du professionnel.</p>
        </div>
        <div class="service-card">
          <h3>Consultations à Domicile</h3>
          <p>Certains professionnels se déplacent chez vous pour plus de confort.</p>
        </div>
        <div class="service-card">
          <h3>Consultations en Vidéo</h3>
          <p>Des rendez-vous en ligne via visioconférence sécurisée.</p>
        </div>
        <div class="service-card">
          <h3>Gestion de Planning</h3>
          <p>Réservation des créneaux et rappels automatiques.</p>
        </div>
        <div class="service-card">
          <h3>Profils Vérifiés</h3>
          <p>Des professionnels certifiés et vérifiés par notre équipe.</p>
        </div>
        <div class="service-card">
          <h3>Support 24/7</h3>
          <p>Accompagnement continu pendant votre parcours.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- CONTACT (intégré version corrigée) -->
  <section id="contact" class="contact-section">
    <div class="contact-container">
      <h2>Nous contacter</h2>
      <p>
        <strong>Bienvenue au Centre d'écoute et de conseil Tighri.</strong><br>
        Si vous avez besoin d'aide et de conseils gratuits, n'hésitez pas à nous contacter.
      </p>

      <div class="contact-info" style="margin-top:1rem;">
        <div class="contact-item">
          <strong>Email</strong>
          <span>contact@tighri.ma</span>
        </div>
        <div class="contact-item">
          <strong>Téléphone</strong>
          <span>06 63 40 01 90</span>
        </div>
        <div class="contact-item">
          <strong>WhatsApp</strong>
          <span class="contact-badge">Disponible</span>
        </div>
      </div>

      <div class="contact-actions">
        <a class="contact-btn" href="mailto:contact@tighri.ma?subject=Contact%20Tighri&body=Bonjour%20Tighri%2C">
          ✉️ Contacter par e-mail
        </a>
        <a class="contact-btn" href="tel:+212663400190">
          📞 Appeler le <span>06 63 40 01 90</span>
        </a>
        <a class="contact-btn" target="_blank" rel="noopener"
           href="https://wa.me/212663400190?text=Bonjour%20Tighri%2C%20j%E2%80%99ai%20besoin%20d%E2%80%99aide%20et%20de%20conseils.">
          💬 WhatsApp direct
        </a>
      </div>
    </div>
  </section>

  <footer>
    <p>&copy; {{  now().year if now is defined else '2024' }} Tighri — Plateforme de santé mentale au Maroc</p>
  </footer>

  <script>
    // Menu mobile
    (function(){
      const btn = document.getElementById('burger');
      const panel = document.getElementById('mobile-menu');
      if(!btn || !panel) return;
      btn.addEventListener('click', function(){
        const open = panel.classList.toggle('open');
        btn.setAttribute('aria-expanded', open ? 'true' : 'false');
      });
      // Fermer au clic d'un lien
      panel.addEventListener('click', (e)=>{
        if(e.target.tagName === 'A'){
          panel.classList.remove('open');
          btn.setAttribute('aria-expanded','false');
        }
      });
    })();
  </script>
</body>
</html>
